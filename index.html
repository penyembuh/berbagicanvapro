<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Berbagi Canva Pro</title>
  <style>
    :root { --bg:#ffffff; --muted:#6b7280; --text:#111827; --accent:#3b82f6; --danger:#ef4444; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;background:#ffffff;color:var(--text)}
    .container{min-height:100dvh;display:grid;place-items:center;padding:24px}
    .card{width:min(520px,100%);background:#ffffff;border:1px solid #e5e7eb;border-radius:16px;padding:24px;box-shadow:0 4px 8px rgba(16,24,40,.06), 0 20px 32px rgba(16,24,40,.10);margin:0 auto}
    h1{margin:0 0 18px;color:#111827;font-size:24px;letter-spacing:.3px;display:flex;align-items:center;justify-content:center;gap:8px}
    p{margin:0 0 18px;color:var(--muted);font-size:14px}
    label{display:block;color:var(--text);font-weight:600;margin-bottom:8px}
    input[type=email]{width:100%;background:#ffffff;border:1px solid #e5e7eb;color:#111827;padding:12px 14px;border-radius:10px;outline:none;font-size:16px}
    input[type=email]:focus{border-color:#3b82f6;box-shadow:0 0 0 3px rgba(59,130,246,.18)}
    .row{display:flex;flex-direction:column;gap:10px;align-items:stretch;margin-top:14px}
    button{appearance:none;border:0;background:var(--accent);color:#ffffff;font-weight:700;padding:12px 16px;border-radius:10px;cursor:pointer}
    button[disabled]{opacity:.6;cursor:not-allowed}
    .msg{margin-left:0;font-size:14px;text-align:center}
    .ok{color:#93c5fd}.err{color:var(--danger)}
    .toolbar{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-top:18px}
    .ghost{background:#f9fafb;color:#111827;border:1px solid #e5e7eb}
    .meter{height:10px;background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;overflow:hidden;margin-top:8px}
    .meter-bar{height:100%;background:linear-gradient(90deg,#3b82f6,#2563eb);width:0%}
    .countRow{display:flex;align-items:baseline;gap:8px;margin-top:8px}
    .countNumber{font-size:28px;color:var(--text);font-weight:800}
    footer{margin-top:16px;color:#6b7280;font-size:12px}
    .small{font-size:12px;color:#9ca3af}
    .admin{margin-top:12px}
    .link{background:#0b1020;color:#cbd5e1;border:1px solid #1f2937;padding:8px 10px;border-radius:8px;cursor:pointer}
    #submitBtn{width:100%;display:flex;align-items:center;justify-content:center;gap:4px;line-height:1.1}
    .title-emoji{display:inline-flex;align-items:center;line-height:1}
    /* Center the consent line under the form only */
    #emailForm .small{ text-align:center; }
    .btn-ico{display:inline-flex;align-items:center;justify-content:center;margin-right:0;line-height:1}
    .btn-ico svg{width:20px;height:20px;display:block;color:var(--accent)}
      /* Topbar */
    .topbar{position:sticky;top:0;z-index:10;display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 16px;background:#ffffff;border-bottom:1px solid #e5e7eb}
    .brand{display:flex;align-items:center;gap:8px;color:var(--text);font-weight:800;letter-spacing:.3px;font-size:18px}
    .brand .gift{font-size:22px}
    .btn-contact{appearance:none;border:0;background:var(--accent);color:#ffffff;text-decoration:none;padding:10px 16px;border-radius:10px;font-weight:700;font-size:15px;display:inline-flex;align-items:center;justify-content:center}
      /* Smooth scroll */
    html{scroll-behavior:smooth}
    /* Help banner under the form */
    .help-banner{max-width:1100px;margin:40px auto 60px;background:#f9fafb;border:1px solid #e5e7eb;border-radius:16px}
    .help-inner{padding:42px 22px;text-align:center}
    .help-title{margin:0 0 14px;font-weight:800;color:#111827;font-size:clamp(24px,4vw,40px);line-height:1.2;font-family:system-ui,-apple-system,'Segoe UI',Roboto,Ubuntu,'Helvetica Neue',Arial,'Noto Sans',sans-serif;letter-spacing:0}
    .help-desc{margin:8px 0;color:#4b5563;font-size:clamp(14px,2vw,18px);line-height:1.7}
    .btn-big{display:inline-flex;align-items:center;justify-content:center;margin-top:22px;padding:16px 28px;border-radius:12px;background:#3b82f6;color:#fff;text-decoration:none;font-weight:800;letter-spacing:.3px;box-shadow:0 8px 18px rgba(59,130,246,.25)}
      /* Footer styles */
    .site-footer{background:#1f2937;color:#e5e7eb;padding:48px 20px}
    .footer-inner{max-width:1200px;margin:0 auto}
    .footer-grid{display:grid;grid-template-columns:1.4fr 1fr 1fr 1fr;gap:32px}
    .footer-about h4{margin:0 0 8px;font-size:22px;font-weight:800;color:#f3f4f6}
    .footer-about .lead{margin:0 0 12px;color:#cbd5e1;font-size:16px}
    .footer-about .desc{margin:0;color:#9ca3af;line-height:1.7}
    .footer-col h5{margin:0 0 12px;font-size:18px;font-weight:800;color:#f3f4f6}
    .footer-col ul{list-style:none;margin:0;padding:0;display:grid;gap:10px}
    .footer-col a{color:#cbd5e1;text-decoration:none}
    .footer-col a:hover{text-decoration:underline}
    .footer-line{border:0;border-top:1px solid #374151;margin:32px 0}
    .footer-bottom{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px;color:#9ca3af;text-align:center;font-size:12px}
    .footer-bottom .madeby .heart{margin:0 6px}
    @media (max-width:900px){.footer-grid{grid-template-columns:1fr 1fr}}
    @media (max-width:600px){.footer-grid{grid-template-columns:1fr}}
      .btn-big:hover{filter:brightness(0.95)}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand"><span class="gift" aria-hidden="true">üéÅ</span><span>CANVA PRO TIM</span></div>
    <a class="btn-contact" href="whatsapp://send?phone=6285811554469&text=halo%20admin">Hubungi</a>
  </header>
  <div class="container">
    <div class="card">
      <h1><span class="title-emoji" aria-hidden="true">üéÅ</span>Berbagi Canva Pro</h1>
      <p>Masukkan email yang akan diundang ke tim Canva Pro. Jika sudah full maka akan di proses invite.</p>

      <form id="emailForm" novalidate>
        <label for="email">Alamat Email</label>
        <input id="email" name="email" type="email" placeholder="nama@email.com" required />
        <div class="row">
          <button id="submitBtn" type="submit"><span class="btn-ico" aria-hidden="true"><svg viewBox="0 0 24 24" width="20" height="20" fill="none"><circle cx="12" cy="12" r="8" fill="#ffffff"/><path d="M9.2 12.5l2.1 2.1 4.1-4.1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></span> Kirim</button>
          <span id="status" class="msg" aria-live="polite"></span>
        </div>
        <p class="small">Dengan mengirim, Anda menyetujui email dicatat untuk proses undangan tim.</p>
      </form>

      <div class="toolbar">
        <h2 style="margin:0;color:var(--text);font-size:18px">Jumlah Email Masuk</h2>
        <div><button type="button" id="refreshBtn" class="ghost">Muat Ulang</button></div>
      </div>

      <div id="counterWrap">
        <div class="countRow">
          <div class="countNumber"><span id="count">0</span> <span class="small">/ 40</span></div>
        </div>
        <div class="meter"><div id="meterBar" class="meter-bar"></div></div>
        <p class="small" id="quotaMsg"></p>
      </div>

      <!-- Panel admin opsional: muncul jika URL mengandung ?admin=1 -->
      <div id="adminPanel" class="admin" style="display:none">
        <button id="resetBtn" class="link">Admin: Reset kuota</button>
        <span class="small" id="resetMsg"></span>
      </div>

      
    </div>
  </div>
  <!-- Help / Contact section -->
  <section id="hubungi" class="help-banner" role="region" aria-labelledby="help-title">
    <div class="help-inner">
      <h3 id="help-title" class="help-title">WEBSITE RESMI BERBAGI CANVA PRO ISGUNANDA</h3>
      <p class="help-desc">Kami berbagi Canva Pro dengan gratis bagi 40 orang yang telah memasukkan email canva-nya.</p>
      <p class="help-desc">Selain itu, kami juga menawarkan berbagai layanan digital lainnya yang bisa disesuaikan dengan kebutuhan kamu.</p>
      <a href="https://ispremium.vercel.app" class="btn-big">KLIK DISINI</a>
    </div>
  </section>

  <!-- Site Footer -->
  <section class="site-footer" role="contentinfo">
    <div class="footer-inner">
      <div class="footer-grid">
        <div class="footer-about">
          <h4>BERBAGI CANVA PRO</h4>
          <p class="lead">Layanan Berbagi Isgunanda</p>
          <p class="desc">Cukup masukkan email kamu, dan kami akan mengundangmu ke tim Canva Pro. Terjamin aman dan memberikan pengalaman terbaik bagi member</p>
        </div>
        <div class="footer-col">
          <h5>Layanan</h5>
          <ul>
            <li><a href="#emailForm">Berbagi Canva Pro</a></li>
            <li><a href="#hubungi">Bantuan Teknis</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h5>Informasi</h5>
          <ul>
            <li><a href="#" target="_blank" rel="noopener">Channel Telegram</a></li>
            <li><a href="#hubungi">Cara Order</a></li>
            <li><a href="#" class="wa-link">Hubungi Admin</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h5>Lainnya</h5>
          <ul>
            <li><a href="#">FAQ</a></li>
          </ul>
        </div>
      </div>
      <hr class="footer-line" />
      <div class="footer-bottom">
        <div>¬© <span id="year-footer"></span> HEALERCOIS.ID All rights reserved.</div>
        <div class="madeby">Made with<span class="heart">‚ù§Ô∏è</span>by <strong>Gunanda</strong></div>
      </div>
    </div>
  </section>

  <script>
    // === GANTI URL WEB APP ANDA (akhiran /exec) ===
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbx3NJ4x53om3oDGHbvBv-gI0fsgIynC7HlopXTEPi0dtS7uU0l2Hmy0LWdZ9qbFt3kewQ/exec";
    const MAX = 40;

    // JSONP helper (hindari CORS)
    function jsonp(url){
      return new Promise((resolve, reject)=>{
        const cb = '__cb_' + Math.random().toString(36).slice(2);
        const sep = url.includes('?') ? '&' : '?';
        const src = url + sep + 'callback=' + cb + '&_=' + Date.now();
        const s = document.createElement('script');
        window[cb] = (data)=>{ cleanup(); resolve(data); };
        function cleanup(){ delete window[cb]; if(s && s.parentNode) s.parentNode.removeChild(s); }
        s.src = src;
        s.onerror = ()=>{ cleanup(); reject(new Error('Gagal memuat')); };
        document.body.appendChild(s);
      });
    }

    // UI refs
    const f = document.getElementById('emailForm');
    const input = document.getElementById('email');
    const btn = document.getElementById('submitBtn');
    const BTN_LABEL = '<span class="btn-ico" aria-hidden="true"><svg viewBox="0 0 24 24" width="20" height="20" fill="none"><circle cx="12" cy="12" r="8" fill="#ffffff"/><path d="M9.2 12.5l2.1 2.1 4.1-4.1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></span> Kirim';
    btn.innerHTML = BTN_LABEL;
    const statusEl = document.getElementById('status');
    const countEl = document.getElementById('count');
    const meterBar = document.getElementById('meterBar');
    const quotaMsg = document.getElementById('quotaMsg');
    const refreshBtn = document.getElementById('refreshBtn');
    const adminPanel = document.getElementById('adminPanel');
    const resetBtn = document.getElementById('resetBtn');
    const resetMsg = document.getElementById('resetMsg');
    var y = document.getElementById('year'); if(y) y.textContent = new Date().getFullYear();
    var yf = document.getElementById('year-footer'); if(yf) yf.textContent = new Date().getFullYear();

    function setStatus(text, ok=true){
      statusEl.textContent = text;
      statusEl.className = 'msg ' + (ok ? 'ok' : 'err');
    }

    function updateCountUI(n){
      countEl.textContent = String(n);
      const pct = Math.max(0, Math.min(100, (n / MAX) * 100));
      meterBar.style.width = pct + '%';
      if(n >= MAX){
        input.disabled = true; btn.disabled = true;
        quotaMsg.textContent = 'Kuota penuh (40/40). Pendaftaran ditutup.';
      }else{
        input.disabled = false; btn.disabled = false;
        quotaMsg.textContent = 'Sisa kuota: ' + (MAX - n) + ' email.';
      }
    }

    async function fetchCount(){
      const data = await jsonp(WEB_APP_URL + '?action=count');
      if(data && data.ok){
        updateCountUI(data.count || 0);
      }else{
        quotaMsg.textContent = (data && data.message) || 'Gagal memuat jumlah.';
      }
    }

    f.addEventListener('submit', async (e)=>{
      e.preventDefault();
      setStatus('');
      const email = (input.value || '').trim();
      if(!email){ setStatus('Email wajib diisi', false); input.focus(); return; }
      if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){ setStatus('Format email tidak valid', false); input.focus(); return; }

      btn.disabled = true; btn.innerHTML = 'Mengirim‚Ä¶';
      try{
        const data = await jsonp(WEB_APP_URL + '?action=add&email=' + encodeURIComponent(email));
        if(data && data.ok){
          setStatus('Berhasil! Email sudah tercatat.');
          f.reset();
          updateCountUI(data.count); // server balas count terbaru
        }else{
          setStatus((data && data.message) || 'Gagal mencatat.', false);
        }
      }catch(err){
        setStatus(err.message || 'Gagal mengirim.', false);
      }finally{
        btn.disabled = false; btn.innerHTML = BTN_LABEL;
      }
    });

    refreshBtn.addEventListener('click', (e)=>{ e.preventDefault(); fetchCount(); });

    // Admin panel opsional via ?admin=1
    const params = new URLSearchParams(location.search);
    if(params.get('admin') === '1'){
      adminPanel.style.display = 'block';
      resetBtn.addEventListener('click', async ()=>{
        const key = prompt('Masukkan ADMIN_KEY untuk reset kuota:');
        if(!key) return;
        resetMsg.textContent = 'Memproses reset‚Ä¶';
        try{
          const r = await jsonp(WEB_APP_URL + '?action=reset&key=' + encodeURIComponent(key));
          if(r && r.ok){
            resetMsg.textContent = 'Reset OK.';
            updateCountUI(0);
          }else{
            resetMsg.textContent = (r && r.message) || 'Reset gagal.';
          }
        }catch(err){
          resetMsg.textContent = err.message || 'Reset gagal.';
        }
      });
    }

    // Deep link WhatsApp (mobile) + fallback (desktop)
    (function(){
      const phone = '6285811554469';
      const text  = encodeURIComponent('halo admin');
      const deep  = 'whatsapp://send?phone='+phone+'&text='+text;
      const web   = 'https://ispremium.vercel.app';
      const isMobile = /Android|iPhone|iPad|iPod|Windows Phone/i.test(navigator.userAgent);
      document.querySelectorAll('.btn-contact, .btn-big, .wa-link').forEach(a=>{
        a.setAttribute('href', isMobile ? deep : web);
        a.setAttribute('rel','noopener');
        a.setAttribute('target','_blank');
      });
    })();

    // Init
    fetchCount();
  </script>
</body>
</html>
